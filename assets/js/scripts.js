!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(g," ")),h.json?JSON.parse(a):a}catch(b){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(arguments.length>1&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setMilliseconds(k.getMilliseconds()+864e5*j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;o>n;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b)}}),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;j=a("./node"),h=j.Position,d=jQuery,e=function(){function a(a){this.tree_widget=a,this.hovered_area=null,this.$ghost=null,this.hit_areas=[],this.is_dragging=!1,this.current_item=null}return a.prototype.mouseCapture=function(a){var b,c;return b=d(a.target),this.mustCaptureElement(b)?this.tree_widget.options.onIsMoveHandle&&!this.tree_widget.options.onIsMoveHandle(b)?null:(c=this.tree_widget._getNodeElement(b),c&&this.tree_widget.options.onCanMove&&(this.tree_widget.options.onCanMove(c.node)||(c=null)),this.current_item=c,null!==this.current_item):null},a.prototype.mouseStart=function(a){var b;return this.refresh(),b=d(a.target).offset(),this.drag_element=new f(this.current_item.node,a.page_x-b.left,a.page_y-b.top,this.tree_widget.element),this.is_dragging=!0,this.current_item.$element.addClass("jqtree-moving"),!0},a.prototype.mouseDrag=function(a){var b,c;return this.drag_element.move(a.page_x,a.page_y),b=this.findHoveredArea(a.page_x,a.page_y),c=this.canMoveToArea(b),c&&b?(b.node.isFolder()||this.stopOpenFolderTimer(),this.hovered_area!==b&&(this.hovered_area=b,this.mustOpenFolderTimer(b)?this.startOpenFolderTimer(b.node):this.stopOpenFolderTimer(),this.updateDropHint())):(this.removeHover(),this.removeDropHint(),this.stopOpenFolderTimer()),b||null!=this.tree_widget.options.onDragMove&&this.tree_widget.options.onDragMove(this.current_item.node,a.original_event),!0},a.prototype.mustCaptureElement=function(a){return!a.is("input,select")},a.prototype.canMoveToArea=function(a){var b;return a?this.tree_widget.options.onCanMoveTo?(b=h.getName(a.position),this.tree_widget.options.onCanMoveTo(this.current_item.node,a.node,b)):!0:!1},a.prototype.mouseStop=function(a){var b;return this.moveItem(a),this.clear(),this.removeHover(),this.removeDropHint(),this.removeHitAreas(),b=this.current_item,this.current_item&&(this.current_item.$element.removeClass("jqtree-moving"),this.current_item=null),this.is_dragging=!1,!this.hovered_area&&b&&null!=this.tree_widget.options.onDragStop&&this.tree_widget.options.onDragStop(b.node,a.original_event),!1},a.prototype.refresh=function(){return this.removeHitAreas(),this.current_item&&(this.generateHitAreas(),this.current_item=this.tree_widget._getNodeElementForNode(this.current_item.node),this.is_dragging)?this.current_item.$element.addClass("jqtree-moving"):void 0},a.prototype.removeHitAreas=function(){return this.hit_areas=[]},a.prototype.clear=function(){return this.drag_element.remove(),this.drag_element=null},a.prototype.removeDropHint=function(){return this.previous_ghost?this.previous_ghost.remove():void 0},a.prototype.removeHover=function(){return this.hovered_area=null},a.prototype.generateHitAreas=function(){var a;return a=new g(this.tree_widget.tree,this.current_item.node,this.getTreeDimensions().bottom),this.hit_areas=a.generate()},a.prototype.findHoveredArea=function(a,b){var c,d,e,f,g;if(d=this.getTreeDimensions(),a<d.left||b<d.top||a>d.right||b>d.bottom)return null;for(f=0,e=this.hit_areas.length;e>f;)if(g=f+e>>1,c=this.hit_areas[g],b<c.top)e=g;else{if(!(b>c.bottom))return c;f=g+1}return null},a.prototype.mustOpenFolderTimer=function(a){var b;return b=a.node,b.isFolder()&&!b.is_open&&a.position===h.INSIDE},a.prototype.updateDropHint=function(){var a;if(this.hovered_area)return this.removeDropHint(),a=this.tree_widget._getNodeElementForNode(this.hovered_area.node),this.previous_ghost=a.addDropHint(this.hovered_area.position)},a.prototype.startOpenFolderTimer=function(a){var b;return b=function(b){return function(){return b.tree_widget._openNode(a,b.tree_widget.options.slide,function(){return b.refresh(),b.updateDropHint()})}}(this),this.stopOpenFolderTimer(),this.open_folder_timer=setTimeout(b,this.tree_widget.options.openFolderDelay)},a.prototype.stopOpenFolderTimer=function(){return this.open_folder_timer?(clearTimeout(this.open_folder_timer),this.open_folder_timer=null):void 0},a.prototype.moveItem=function(a){var b,c,d,e,f,g;return this.hovered_area&&this.hovered_area.position!==h.NONE&&this.canMoveToArea(this.hovered_area)&&(d=this.current_item.node,g=this.hovered_area.node,e=this.hovered_area.position,f=d.parent,e===h.INSIDE&&(this.hovered_area.node.is_open=!0),b=function(a){return function(b,c){return a.tree_widget.tree.moveNode(d,b||g,c||e),a.tree_widget.element.empty(),a.tree_widget._refreshElements()}}(this),c=this.tree_widget._triggerEvent("tree.move",{move_info:{moved_node:d,target_node:g,position:h.getName(e),previous_parent:f,do_move:b,original_event:a.original_event}}),!c.isDefaultPrevented())?b():void 0},a.prototype.getTreeDimensions=function(){var a;return a=this.tree_widget.element.offset(),{left:a.left,top:a.top,right:a.left+this.tree_widget.element.width(),bottom:a.top+this.tree_widget.element.height()+16}},a}(),i=function(){function a(a){this.tree=a}return a.prototype.iterate=function(){var a,b;return b=!0,(a=function(c){return function(e,f){var g,h,i,j,k,l,m,n;if(m=(e.is_open||!e.element)&&e.hasChildren(),e.element){if(g=d(e.element),!g.is(":visible"))return;b&&(c.handleFirstNode(e,g),b=!1),e.hasChildren()?e.is_open?c.handleOpenFolder(e,g)||(m=!1):c.handleClosedFolder(e,f,g):c.handleNode(e,f,g)}if(m){for(i=e.children.length,n=e.children,j=k=0,l=n.length;l>k;j=++k)h=n[j],j===i-1?a(e.children[j],null):a(e.children[j],e.children[j+1]);if(e.is_open)return c.handleAfterOpenFolder(e,f,g)}}}(this))(this.tree,null)},a.prototype.handleNode=function(a,b,c){},a.prototype.handleOpenFolder=function(a,b){},a.prototype.handleClosedFolder=function(a,b,c){},a.prototype.handleAfterOpenFolder=function(a,b,c){},a.prototype.handleFirstNode=function(a,b){},a}(),g=function(a){function b(a,c,d){b.__super__.constructor.call(this,a),this.current_node=c,this.tree_bottom=d}return k(b,a),b.prototype.generate=function(){return this.positions=[],this.last_top=0,this.iterate(),this.generateHitAreas(this.positions)},b.prototype.getTop=function(a){return a.offset().top},b.prototype.addPosition=function(a,b,c){var d;return d={top:c,node:a,position:b},this.positions.push(d),this.last_top=c},b.prototype.handleNode=function(a,b,c){var d;return d=this.getTop(c),a===this.current_node?this.addPosition(a,h.NONE,d):this.addPosition(a,h.INSIDE,d),b===this.current_node||a===this.current_node?this.addPosition(a,h.NONE,d):this.addPosition(a,h.AFTER,d)},b.prototype.handleOpenFolder=function(a,b){return a.children[0]!==this.current_node&&this.addPosition(a,h.INSIDE,this.getTop(b)),!0},b.prototype.handleClosedFolder=function(a,b,c){var d;return d=this.getTop(c),a===this.current_node?this.addPosition(a,h.NONE,d):(this.addPosition(a,h.INSIDE,d),b!==this.current_node?this.addPosition(a,h.AFTER,d):void 0)},b.prototype.handleFirstNode=function(a,b){return a!==this.current_node?this.addPosition(a,h.BEFORE,this.getTop(d(a.element))):void 0},b.prototype.handleAfterOpenFolder=function(a,b,c){return a===this.current_node.node||b===this.current_node.node?this.addPosition(a,h.NONE,this.last_top):this.addPosition(a,h.AFTER,this.last_top)},b.prototype.generateHitAreas=function(a){var b,c,d,e,f,g;for(g=-1,b=[],c=[],d=0,e=a.length;e>d;d++)f=a[d],f.top!==g&&b.length&&(b.length&&this.generateHitAreasForGroup(c,b,g,f.top),g=f.top,b=[]),b.push(f);return this.generateHitAreasForGroup(c,b,g,this.tree_bottom),c},b.prototype.generateHitAreasForGroup=function(a,b,c,d){var e,f,g,h,i,j=0;for(i=Math.min(b.length,4),e=Math.round((d-c)/i),f=c,g=0;i>g;)h=b[g],j=0,a.push({top:f,bottom:f+e-j,node:h.node,position:h.position}),f+=e,g+=1;return null},b}(i),f=function(){function a(a,b,c,e){this.offset_x=b,this.offset_y=c,this.$element=d('<span class="jqtree-title jqtree-dragging">'+a.name+"</span>"),this.$element.css("position","absolute"),e.append(this.$element)}return a.prototype.move=function(a,b){return this.$element.offset({left:a-this.offset_x,top:b-this.offset_y})},a.prototype.remove=function(){return this.$element.remove()},a}(),b.exports={DragAndDropHandler:e,DragElement:f,HitAreasGenerator:g}},{"./node":5}],2:[function(a,b,c){var d,e,f,g,h,i;h=a("./node_element"),f=h.NodeElement,i=a("./util"),g=i.html_escape,d=jQuery,e=function(){function a(a){this.tree_widget=a,this.opened_icon_element=this.createButtonElement(a.options.openedIcon),this.closed_icon_element=this.createButtonElement(a.options.closedIcon)}return a.prototype.render=function(a){return a&&a.parent?this.renderFromNode(a):this.renderFromRoot()},a.prototype.renderFromRoot=function(){var a;return a=this.tree_widget.element,a.empty(),this.createDomElements(a[0],this.tree_widget.tree.children,!0,!0,1)},a.prototype.renderFromNode=function(a){var b,c;return b=d(a.element),c=this.createLi(a),this.attachNodeData(a,c),b.after(c),b.remove(),a.children?this.createDomElements(c,a.children,!1,!1,a.getLevel()):void 0},a.prototype.createDomElements=function(a,b,c,d,e){var f,g,h,i,j;for(j=this.createUl(c),a.appendChild(j),g=0,h=b.length;h>g;g++)f=b[g],i=this.createLi(f,e),j.appendChild(i),this.attachNodeData(f,i),f.hasChildren()&&this.createDomElements(i,f.children,!1,f.is_open,e+1);return null},a.prototype.attachNodeData=function(a,b){return a.element=b,d(b).data("node",a)},a.prototype.createUl=function(a){var b,c,d;return a?(b="jqtree-tree",c="tree",this.tree_widget.options.rtl&&(b+=" jqtree-rtl")):(b="",c="group"),d=document.createElement("ul"),d.className="jqtree_common "+b,d.setAttribute("role",c),d},a.prototype.createLi=function(a,b){var c,e;return c=this.tree_widget.select_node_handler&&this.tree_widget.select_node_handler.isNodeSelected(a),e=a.isFolder()?this.createFolderLi(a,b,c):this.createNodeLi(a,b,c),this.tree_widget.options.onCreateLi&&this.tree_widget.options.onCreateLi(a,d(e)),e},a.prototype.createFolderLi=function(a,b,c){var d,e,f,g,h,i,j;return d=this.getButtonClasses(a),g=this.getFolderClasses(a,c),h=a.is_open?this.opened_icon_element:this.closed_icon_element,j=document.createElement("li"),j.className="jqtree_common "+g,j.setAttribute("role","presentation"),f=document.createElement("div"),f.className="jqtree-element jqtree_common",f.setAttribute("role","presentation"),j.appendChild(f),e=document.createElement("a"),e.className=d,e.appendChild(h.cloneNode(!1)),e.setAttribute("role","presentation"),e.setAttribute("aria-hidden","true"),this.tree_widget.options.buttonLeft&&f.appendChild(e),f.appendChild(this.createTitleSpan(a.name,b,c,a.is_open,i=!0)),this.tree_widget.options.buttonLeft||f.appendChild(e),j},a.prototype.createNodeLi=function(a,b,c){var d,e,f,g,h;return h=["jqtree_common"],c&&h.push("jqtree-selected"),d=h.join(" "),g=document.createElement("li"),g.className=d,g.setAttribute("role","presentation"),e=document.createElement("div"),e.className="jqtree-element jqtree_common",e.setAttribute("role","presentation"),g.appendChild(e),e.appendChild(this.createTitleSpan(a.name,b,c,a.is_open,f=!1)),g},a.prototype.createTitleSpan=function(a,b,c,d,e){var f,g;return g=document.createElement("span"),f="jqtree-title jqtree_common",e&&(f+=" jqtree-title-folder"),g.className=f,g.setAttribute("role","treeitem"),g.setAttribute("aria-level",b),g.setAttribute("aria-selected",i.getBoolString(c)),g.setAttribute("aria-expanded",i.getBoolString(d)),c&&g.setAttribute("tabindex",0),g.innerHTML=this.escapeIfNecessary(a),g},a.prototype.getButtonClasses=function(a){var b;return b=["jqtree-toggler","jqtree_common"],a.is_open||b.push("jqtree-closed"),this.tree_widget.options.buttonLeft?b.push("jqtree-toggler-left"):b.push("jqtree-toggler-right"),b.join(" ")},a.prototype.getFolderClasses=function(a,b){var c;return c=["jqtree-folder"],a.is_open||c.push("jqtree-closed"),b&&c.push("jqtree-selected"),a.is_loading&&c.push("jqtree-loading"),c.join(" ")},a.prototype.escapeIfNecessary=function(a){return this.tree_widget.options.autoEscape?g(a):a},a.prototype.createButtonElement=function(a){var b;return"string"==typeof a?(b=document.createElement("div"),b.innerHTML=a,document.createTextNode(b.innerHTML)):d(a)[0]},a}(),b.exports=e},{"./node_element":6,"./util":12}],3:[function(a,b,c){var d,e,f=function(a,b){return function(){return a.apply(b,arguments)}};d=jQuery,e=function(){function a(a){this.selectNode=f(this.selectNode,this),this.tree_widget=a,a.options.keyboardSupport&&d(document).bind("keydown.jqtree",d.proxy(this.handleKeyDown,this))}var b,c,e,g;return c=37,g=38,e=39,b=40,a.prototype.deinit=function(){return d(document).unbind("keydown.jqtree")},a.prototype.moveDown=function(){var a;return a=this.tree_widget.getSelectedNode(),a?this.selectNode(a.getNextNode()):!1},a.prototype.moveUp=function(){var a;return a=this.tree_widget.getSelectedNode(),a?this.selectNode(a.getPreviousNode()):!1},a.prototype.moveRight=function(){var a;return a=this.tree_widget.getSelectedNode(),a&&a.isFolder()?a.is_open?this.selectNode(a.getNextNode()):(this.tree_widget.openNode(a),!1):!0},a.prototype.moveLeft=function(){var a;return a=this.tree_widget.getSelectedNode(),a?a.isFolder()&&a.is_open?(this.tree_widget.closeNode(a),!1):this.selectNode(a.getParent()):!0},a.prototype.handleKeyDown=function(a){var f;if(!this.tree_widget.options.keyboardSupport)return!0;if(d(document.activeElement).is("textarea,input,select"))return!0;if(!this.tree_widget.getSelectedNode())return!0;switch(f=a.which){case b:return this.moveDown();case g:return this.moveUp();case e:return this.moveRight();case c:return this.moveLeft()}return!0},a.prototype.selectNode=function(a){return a?(this.tree_widget.selectNode(a),this.tree_widget.scroll_handler&&!this.tree_widget.scroll_handler.isScrolledIntoView(d(a.element).find(".jqtree-element"))&&this.tree_widget.scrollToNode(a),!1):!0},a}(),b.exports=e},{}],4:[function(a,b,c){var d,e,f,g=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h={}.hasOwnProperty;f=a("./simple.widget"),d=jQuery,e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.is_mouse_handled=!1,b.prototype._init=function(){return this.$el.bind("mousedown.mousewidget",d.proxy(this._mouseDown,this)),this.$el.bind("touchstart.mousewidget",d.proxy(this._touchStart,this)),this.is_mouse_started=!1,this.mouse_delay=0,this._mouse_delay_timer=null,this._is_mouse_delay_met=!0,this.mouse_down_info=null},b.prototype._deinit=function(){var a;return this.$el.unbind("mousedown.mousewidget"),this.$el.unbind("touchstart.mousewidget"),a=d(document),a.unbind("mousemove.mousewidget"),a.unbind("mouseup.mousewidget")},b.prototype._mouseDown=function(a){var b;if(1===a.which)return b=this._handleMouseDown(a,this._getPositionInfo(a)),b&&a.preventDefault(),b},b.prototype._handleMouseDown=function(a,c){return!b.is_mouse_handled&&(this.is_mouse_started&&this._handleMouseUp(c),this.mouse_down_info=c,this._mouseCapture(c))?(this._handleStartMouse(a),this.is_mouse_handled=!0,!0):void 0},b.prototype._handleStartMouse=function(a){var b;return b=d(document),b.bind("mousemove.mousewidget",d.proxy(this._mouseMove,this)),b.bind("touchmove.mousewidget",d.proxy(this._touchMove,this)),b.bind("mouseup.mousewidget",d.proxy(this._mouseUp,this)),b.bind("touchend.mousewidget",d.proxy(this._touchEnd,this)),this.mouse_delay?this._startMouseDelayTimer():void 0},b.prototype._startMouseDelayTimer=function(){return this._mouse_delay_timer&&clearTimeout(this._mouse_delay_timer),this._mouse_delay_timer=setTimeout(function(a){return function(){return a._is_mouse_delay_met=!0}}(this),this.mouse_delay),this._is_mouse_delay_met=!1},b.prototype._mouseMove=function(a){return this._handleMouseMove(a,this._getPositionInfo(a))},b.prototype._handleMouseMove=function(a,b){return this.is_mouse_started?(this._mouseDrag(b),a.preventDefault()):this.mouse_delay&&!this._is_mouse_delay_met?!0:(this.is_mouse_started=this._mouseStart(this.mouse_down_info)!==!1,this.is_mouse_started?this._mouseDrag(b):this._handleMouseUp(b),!this.is_mouse_started)},b.prototype._getPositionInfo=function(a){return{page_x:a.pageX,page_y:a.pageY,target:a.target,original_event:a}},b.prototype._mouseUp=function(a){return this._handleMouseUp(this._getPositionInfo(a))},b.prototype._handleMouseUp=function(a){var b;b=d(document),b.unbind("mousemove.mousewidget"),b.unbind("touchmove.mousewidget"),b.unbind("mouseup.mousewidget"),b.unbind("touchend.mousewidget"),this.is_mouse_started&&(this.is_mouse_started=!1,this._mouseStop(a))},b.prototype._mouseCapture=function(a){return!0},b.prototype._mouseStart=function(a){return null},b.prototype._mouseDrag=function(a){return null},b.prototype._mouseStop=function(a){return null},b.prototype.setMouseDelay=function(a){return this.mouse_delay=a},b.prototype._touchStart=function(a){var b;if(!(a.originalEvent.touches.length>1))return b=a.originalEvent.changedTouches[0],this._handleMouseDown(a,this._getPositionInfo(b))},b.prototype._touchMove=function(a){var b;return a.preventDefault(),a.originalEvent.touches.length>1?void 0:(b=a.originalEvent.changedTouches[0],this._handleMouseMove(a,this._getPositionInfo(b)))},b.prototype._touchEnd=function(a){var b;if(!(a.originalEvent.touches.length>1))return b=a.originalEvent.changedTouches[0],this._handleMouseUp(this._getPositionInfo(b))},b}(f),b.exports=e},{"./simple.widget":10}],5:[function(a,b,c){var d,e,f;d=jQuery,f={getName:function(a){return f.strings[a-1]},nameToIndex:function(a){var b,c,d;for(b=c=1,d=f.strings.length;d>=1?d>=c:c>=d;b=d>=1?++c:--c)if(f.strings[b-1]===a)return b;return 0}},f.BEFORE=1,f.AFTER=2,f.INSIDE=3,f.NONE=4,f.strings=["before","after","inside","none"],e=function(){function a(b,c,d){null==c&&(c=!1),null==d&&(d=a),this.name="",this.setData(b),this.children=[],this.parent=null,c&&(this.id_mapping={},this.tree=this,this.node_class=d)}return a.prototype.setData=function(a){var b,c,d;if(c=function(a){return function(b){return null!==b?a.name=b:void 0}}(this),"object"!=typeof a)c(a);else for(b in a)d=a[b],"label"===b?c(d):this[b]=d;return null},a.prototype.initFromData=function(a){var b,c;return c=function(a){return function(c){return a.setData(c),c.children?b(c.children):void 0}}(this),b=function(a){return function(b){var c,d,e,f;for(d=0,e=b.length;e>d;d++)c=b[d],f=new a.tree.node_class(""),f.initFromData(c),a.addChild(f);return null}}(this),c(a),null},a.prototype.loadFromData=function(a){var b,c,d,e;for(this.removeChildren(),b=0,c=a.length;c>b;b++)e=a[b],d=new this.tree.node_class(e),this.addChild(d),"object"==typeof e&&e.children&&d.loadFromData(e.children);return null},a.prototype.addChild=function(a){return this.children.push(a),a._setParent(this)},a.prototype.addChildAtPosition=function(a,b){return this.children.splice(b,0,a),a._setParent(this)},a.prototype._setParent=function(a){return this.parent=a,this.tree=a.tree,this.tree.addNodeToIndex(this)},a.prototype.removeChild=function(a){return a.removeChildren(),this._removeChild(a)},a.prototype._removeChild=function(a){return this.children.splice(this.getChildIndex(a),1),this.tree.removeNodeFromIndex(a)},a.prototype.getChildIndex=function(a){return d.inArray(a,this.children)},a.prototype.hasChildren=function(){return 0!==this.children.length},a.prototype.isFolder=function(){return this.hasChildren()||this.load_on_demand},a.prototype.iterate=function(a){var b;return b=function(c,d){var e,f,g,h,i;if(c.children){for(h=c.children,f=0,g=h.length;g>f;f++)e=h[f],i=a(e,d),i&&e.hasChildren()&&b(e,d+1);return null}},b(this,0),null},a.prototype.moveNode=function(a,b,c){return a.isParentOf(b)?void 0:(a.parent._removeChild(a),c===f.AFTER?b.parent.addChildAtPosition(a,b.parent.getChildIndex(b)+1):c===f.BEFORE?b.parent.addChildAtPosition(a,b.parent.getChildIndex(b)):c===f.INSIDE?b.addChildAtPosition(a,0):void 0)},a.prototype.getData=function(a){var b;return null==a&&(a=!1),(b=function(a){var c,d,e,f,g,h,i;for(c=[],d=0,f=a.length;f>d;d++){g=a[d],h={};for(e in g)i=g[e],"parent"!==e&&"children"!==e&&"element"!==e&&"tree"!==e&&Object.prototype.hasOwnProperty.call(g,e)&&(h[e]=i);g.hasChildren()&&(h.children=b(g.children)),c.push(h)}return c})(a?[this]:this.children)},a.prototype.getNodeByName=function(a){var b;return b=null,this.iterate(function(c){return c.name===a?(b=c,!1):!0}),b},a.prototype.addAfter=function(a){var b,c;return this.parent?(c=new this.tree.node_class(a),b=this.parent.getChildIndex(this),this.parent.addChildAtPosition(c,b+1),c):null},a.prototype.addBefore=function(a){var b,c;return this.parent?(c=new this.tree.node_class(a),b=this.parent.getChildIndex(this),this.parent.addChildAtPosition(c,b),c):null},a.prototype.addParent=function(a){var b,c,d,e,f,g;if(this.parent){for(e=new this.tree.node_class(a),e._setParent(this.tree),f=this.parent,g=f.children,c=0,d=g.length;d>c;c++)b=g[c],e.addChild(b);return f.children=[],f.addChild(e),e}return null},a.prototype.remove=function(){return this.parent?(this.parent.removeChild(this),this.parent=null):void 0},a.prototype.append=function(a){var b;return b=new this.tree.node_class(a),this.addChild(b),b},a.prototype.prepend=function(a){var b;return b=new this.tree.node_class(a),this.addChildAtPosition(b,0),b},a.prototype.isParentOf=function(a){var b;for(b=a.parent;b;){if(b===this)return!0;b=b.parent}return!1},a.prototype.getLevel=function(){var a,b;for(a=0,b=this;b.parent;)a+=1,b=b.parent;return a},a.prototype.getNodeById=function(a){return this.id_mapping[a]},a.prototype.addNodeToIndex=function(a){return null!=a.id?this.id_mapping[a.id]=a:void 0},a.prototype.removeNodeFromIndex=function(a){return null!=a.id?delete this.id_mapping[a.id]:void 0},a.prototype.removeChildren=function(){return this.iterate(function(a){return function(b){return a.tree.removeNodeFromIndex(b),!0}}(this)),this.children=[]},a.prototype.getPreviousSibling=function(){var a;return this.parent?(a=this.parent.getChildIndex(this)-1,a>=0?this.parent.children[a]:null):null},a.prototype.getNextSibling=function(){var a;return this.parent?(a=this.parent.getChildIndex(this)+1,a<this.parent.children.length?this.parent.children[a]:null):null},a.prototype.getNodesByProperty=function(a,b){return this.filter(function(c){return c[a]===b})},a.prototype.filter=function(a){var b;return b=[],this.iterate(function(c){return a(c)&&b.push(c),!0}),b},a.prototype.getNextNode=function(a){var b;return null==a&&(a=!0),a&&this.hasChildren()&&this.is_open?this.children[0]:this.parent?(b=this.getNextSibling(),b?b:this.parent.getNextNode(!1)):null},a.prototype.getPreviousNode=function(){var a;return this.parent?(a=this.getPreviousSibling(),a?a.hasChildren()&&a.is_open?a.getLastChild():a:this.getParent()):null},a.prototype.getParent=function(){return this.parent&&this.parent.parent?this.parent:null},a.prototype.getLastChild=function(){var a;return this.hasChildren()?(a=this.children[this.children.length-1],a.hasChildren()&&a.is_open?a.getLastChild():a):null},a}(),b.exports={Node:e,Position:f}},{}],6:[function(a,b,c){var d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;j=a("./node"),i=j.Position,d=jQuery,h=function(){function a(a,b){this.init(a,b)}return a.prototype.init=function(a,b){return this.node=a,this.tree_widget=b,a.element||(a.element=this.tree_widget.element),this.$element=d(a.element)},a.prototype.getUl=function(){return this.$element.children("ul:first")},a.prototype.getSpan=function(){return this.$element.children(".jqtree-element").find("span.jqtree-title")},a.prototype.getLi=function(){return this.$element},a.prototype.addDropHint=function(a){return a===i.INSIDE?new e(this.$element):new g(this.node,this.$element,a)},a.prototype.select=function(){var a,b;return a=this.getLi(),a.addClass("jqtree-selected"),a.attr("aria-selected","true"),b=this.getSpan(),b.attr("tabindex",0)},a.prototype.deselect=function(){var a,b;return a=this.getLi(),a.removeClass("jqtree-selected"),a.attr("aria-selected","false"),b=this.getSpan(),b.attr("tabindex",-1)},a}(),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.open=function(a,b){var c,d;return null==b&&(b=!0),this.node.is_open?void 0:(this.node.is_open=!0,c=this.getButton(),c.removeClass("jqtree-closed"),c.html(""),c.append(this.tree_widget.renderer.opened_icon_element.cloneNode(!1)),d=function(b){return function(){var c,d;return c=b.getLi(),c.removeClass("jqtree-closed"),d=b.getSpan(),d.attr("aria-expanded","true"),a&&a(),b.tree_widget._triggerEvent("tree.open",{node:b.node})}}(this),b?this.getUl().slideDown("fast",d):(this.getUl().show(),d()))},b.prototype.close=function(a){var b,c;return null==a&&(a=!0),this.node.is_open?(this.node.is_open=!1,b=this.getButton(),b.addClass("jqtree-closed"),b.html(""),b.append(this.tree_widget.renderer.closed_icon_element.cloneNode(!1)),c=function(a){return function(){var b,c;return b=a.getLi(),b.addClass("jqtree-closed"),c=a.getSpan(),c.attr("aria-expanded","false"),a.tree_widget._triggerEvent("tree.close",{node:a.node})}}(this),a?this.getUl().slideUp("fast",c):(this.getUl().hide(),c())):void 0},b.prototype.getButton=function(){return this.$element.children(".jqtree-element").find("a.jqtree-toggler")},b.prototype.addDropHint=function(a){return this.node.is_open&&this.tree_widget.dnd_handler.current_item.node.parent.id==this.node.id||a!==i.INSIDE?new g(this.node,this.$element,a):new e(this.$element)},b}(h),e=function(){function a(a){var b,c;b=a.children(".jqtree-element"),c=a.width()-4,this.$hint=d('<span class="jqtree-border"></span>'),b.append(this.$hint),this.$hint.css({width:c,height:b.outerHeight()-4})}return a.prototype.remove=function(){return this.$hint.remove()},a}(),g=function(){function a(a,b,c){this.$element=b,this.node=a,this.$ghost=d('<li class="jqtree_common jqtree-ghost"><span class="jqtree_common jqtree-circle"></span><span class="jqtree_common jqtree-line"></span></li>'),c===i.AFTER?this.moveAfter():c===i.BEFORE?this.moveBefore():c===i.INSIDE&&(a.isFolder()&&a.is_open?this.moveInsideOpenFolder():this.moveInside())}return a.prototype.remove=function(){return this.$ghost.remove()},a.prototype.moveAfter=function(){return this.$element.after(this.$ghost)},a.prototype.moveBefore=function(){return this.$element.before(this.$ghost)},a.prototype.moveInsideOpenFolder=function(){return d(this.node.children[0].element).before(this.$ghost)},a.prototype.moveInside=function(){return this.$element.after(this.$ghost),this.$ghost.addClass("jqtree-inside")},a}(),b.exports={BorderDropHint:e,FolderElement:f,GhostDropHint:g,NodeElement:h}},{"./node":5}],7:[function(a,b,c){var d,e,f,g,h;h=a("./util"),f=h.indexOf,g=h.isInt,d=jQuery,e=function(){function a(a){this.tree_widget=a}return a.prototype.saveState=function(){var a;return a=JSON.stringify(this.getState()),this.tree_widget.options.onSetStateFromStorage?this.tree_widget.options.onSetStateFromStorage(a):this.supportsLocalStorage()?localStorage.setItem(this.getCookieName(),a):d.cookie?(d.cookie.raw=!0,d.cookie(this.getCookieName(),a,{path:"/"})):void 0},a.prototype.getStateFromStorage=function(){var a;return a=this._loadFromStorage(),a?this._parseState(a):null},a.prototype._parseState=function(a){var b;return b=d.parseJSON(a),b&&b.selected_node&&g(b.selected_node)&&(b.selected_node=[b.selected_node]),b},a.prototype._loadFromStorage=function(){return this.tree_widget.options.onGetStateFromStorage?this.tree_widget.options.onGetStateFromStorage():this.supportsLocalStorage()?localStorage.getItem(this.getCookieName()):d.cookie?(d.cookie.raw=!0,d.cookie(this.getCookieName())):null},a.prototype.getState=function(){var a,b;return a=function(a){return function(){var b;return b=[],a.tree_widget.tree.iterate(function(a){return a.is_open&&a.id&&a.hasChildren()&&b.push(a.id),!0}),b}}(this),b=function(a){return function(){var b;return function(){var a,c,d,e;for(d=this.tree_widget.getSelectedNodes(),e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(b.id);return e}.call(a)}}(this),{open_nodes:a(),selected_node:b()}},a.prototype.setInitialState=function(a){var b;return a?(b=this._openInitialNodes(a.open_nodes),this._selectInitialNodes(a.selected_node),b):!1},a.prototype._openInitialNodes=function(a){var b,c,d,e,f;for(d=!1,b=0,c=a.length;c>b;b++)f=a[b],e=this.tree_widget.getNodeById(f),e&&(e.load_on_demand?d=!0:e.is_open=!0);return d},a.prototype._selectInitialNodes=function(a){var b,c,d,e,f;for(f=0,b=0,c=a.length;c>b;b++)e=a[b],d=this.tree_widget.getNodeById(e),d&&(f+=1,this.tree_widget.select_node_handler.addToSelection(d));return 0!==f},a.prototype.setInitialStateOnDemand=function(a,b){return a?this._setInitialStateOnDemand(a.open_nodes,a.selected_node,b):b()},a.prototype._setInitialStateOnDemand=function(a,b,c){var d,e,f;return e=0,f=function(f){return function(){var g,h,i,j,k;for(i=[],g=0,h=a.length;h>g;g++)k=a[g],j=f.tree_widget.getNodeById(k),j?j.is_loading||(j.load_on_demand?d(j):f.tree_widget._openNode(j,!1)):i.push(k);return a=i,f._selectInitialNodes(b)&&f.tree_widget._refreshElements(),0===e?c():void 0}}(this),d=function(a){return function(b){return e+=1,a.tree_widget._openNode(b,!1,function(){return e-=1,f()})}}(this),f()},a.prototype.getCookieName=function(){return"string"==typeof this.tree_widget.options.saveState?this.tree_widget.options.saveState:"tree"},a.prototype.supportsLocalStorage=function(){var a;return a=function(){var a,b,c;if("undefined"==typeof localStorage||null===localStorage)return!1;try{c="_storage_test",sessionStorage.setItem(c,!0),sessionStorage.removeItem(c)}catch(b){return a=b,!1}return!0},null==this._supportsLocalStorage&&(this._supportsLocalStorage=a()),this._supportsLocalStorage},a.prototype.getNodeIdToBeSelected=function(){var a;return a=this.getStateFromStorage(),a&&a.selected_node?a.selected_node[0]:null},a}(),b.exports=e},{"./util":12}],8:[function(a,b,c){var d,e;d=jQuery,e=function(){function a(a){this.tree_widget=a,this.previous_top=-1,this.is_initialized=!1,this._initScrollParent()}return a.prototype._initScrollParent=function(){var a,b,c;return b=function(a){return function(){var b,c,e,f,g,h;if(b=["overflow","overflow-y"],(e=function(a){var c,e,f,g;for(e=0,f=b.length;f>e;e++)if(c=b[e],"auto"===(g=d.css(a,c))||"scroll"===g)return!0;return!1})(a.tree_widget.$el[0]))return a.tree_widget.$el;
for(h=a.tree_widget.$el.parents(),f=0,g=h.length;g>f;f++)if(c=h[f],e(c))return d(c);return null}}(this),c=function(a){return function(){return a.scroll_parent_top=0,a.$scroll_parent=null}}(this),"fixed"===this.tree_widget.$el.css("position")&&c(),a=b(),a&&a.length&&"HTML"!==a[0].tagName?(this.$scroll_parent=a,this.scroll_parent_top=this.$scroll_parent.offset().top):c(),this.is_initialized=!0},a.prototype._ensureInit=function(){return this.is_initialized?void 0:this._initScrollParent()},a.prototype.checkScrolling=function(){var a;return this._ensureInit(),a=this.tree_widget.dnd_handler.hovered_area,a&&a.top!==this.previous_top?(this.previous_top=a.top,this.$scroll_parent?this._handleScrollingWithScrollParent(a):this._handleScrollingWithDocument(a)):void 0},a.prototype._handleScrollingWithScrollParent=function(a){var b;return b=this.scroll_parent_top+this.$scroll_parent[0].offsetHeight-a.bottom,20>b?(this.$scroll_parent[0].scrollTop+=20,this.tree_widget.refreshHitAreas(),this.previous_top=-1):a.top-this.scroll_parent_top<20?(this.$scroll_parent[0].scrollTop-=20,this.tree_widget.refreshHitAreas(),this.previous_top=-1):void 0},a.prototype._handleScrollingWithDocument=function(a){var b;return b=a.top-d(document).scrollTop(),20>b?d(document).scrollTop(d(document).scrollTop()-20):d(window).height()-(a.bottom-d(document).scrollTop())<20?d(document).scrollTop(d(document).scrollTop()+20):void 0},a.prototype.scrollTo=function(a){var b;return this._ensureInit(),this.$scroll_parent?this.$scroll_parent[0].scrollTop=a:(b=this.tree_widget.$el.offset().top,d(document).scrollTop(a+b))},a.prototype.isScrolledIntoView=function(a){var b,c,e,f,g;return this._ensureInit(),b=d(a),this.$scroll_parent?(g=0,f=this.$scroll_parent.height(),e=b.offset().top-this.scroll_parent_top,c=e+b.height()):(g=d(window).scrollTop(),f=g+d(window).height(),e=b.offset().top,c=e+b.height()),f>=c&&e>=g},a}(),b.exports=e},{}],9:[function(a,b,c){var d,e;d=jQuery,e=function(){function a(a){this.tree_widget=a,this.clear()}return a.prototype.getSelectedNode=function(){var a;return a=this.getSelectedNodes(),a.length?a[0]:!1},a.prototype.getSelectedNodes=function(){var a,b,c;if(this.selected_single_node)return[this.selected_single_node];c=[];for(a in this.selected_nodes)b=this.tree_widget.getNodeById(a),b&&c.push(b);return c},a.prototype.getSelectedNodesUnder=function(a){var b,c,d;if(this.selected_single_node)return a.isParentOf(this.selected_single_node)?[this.selected_single_node]:[];d=[];for(b in this.selected_nodes)c=this.tree_widget.getNodeById(b),c&&a.isParentOf(c)&&d.push(c);return d},a.prototype.isNodeSelected=function(a){return a.id?this.selected_nodes[a.id]:this.selected_single_node?this.selected_single_node.element===a.element:!1},a.prototype.clear=function(){return this.selected_nodes={},this.selected_single_node=null},a.prototype.removeFromSelection=function(a,b){if(null==b&&(b=!1),a.id){if(delete this.selected_nodes[a.id],b)return a.iterate(function(b){return function(c){return delete b.selected_nodes[a.id],!0}}(this))}else if(this.selected_single_node&&a.element===this.selected_single_node.element)return this.selected_single_node=null},a.prototype.addToSelection=function(a){return a.id?this.selected_nodes[a.id]=!0:this.selected_single_node=a},a}(),b.exports=e},{}],10:[function(a,b,c){var d,e,f=[].slice;d=jQuery,e=function(){function a(a,b){this.$el=d(a),this.options=d.extend({},this.defaults,b)}return a.prototype.defaults={},a.prototype.destroy=function(){return this._deinit()},a.prototype._init=function(){return null},a.prototype._deinit=function(){return null},a.register=function(b,c){var e,g,h,i,j;return i=function(){return"simple_widget_"+c},j=function(b,c){var e;return e=d.data(b,c),e&&e instanceof a?e:null},g=function(a,c){var e,f,g,h,k,l;for(e=i(),h=0,k=a.length;k>h;h++)f=a[h],g=j(f,e),g||(l=new b(f,c),d.data(f,e)||d.data(f,e,l),l._init());return a},h=function(a){var b,c,e,f,g,h;for(b=i(),g=[],e=0,f=a.length;f>e;e++)c=a[e],h=j(c,b),h&&h.destroy(),g.push(d.removeData(c,b));return g},e=function(b,c,e){var f,g,h,j,k,l;for(j=null,g=0,h=b.length;h>g;g++)f=b[g],k=d.data(f,i()),k&&k instanceof a&&(l=k[c],l&&"function"==typeof l&&(j=l.apply(k,e)));return j},d.fn[c]=function(){var a,c,d,i,j;return d=arguments[0],c=2<=arguments.length?f.call(arguments,1):[],a=this,void 0===d||"object"==typeof d?(j=d,g(a,j)):"string"==typeof d&&"_"!==d[0]?(i=d,"destroy"===i?h(a):"get_widget_class"===i?b:e(a,i,c)):void 0}},a}(),b.exports=e},{}],11:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=function(a,b){function c(){this.constructor=a}for(var d in b)B.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},B={}.hasOwnProperty;v=a("./version"),x=a("./drag_and_drop_handler"),f=x.DragAndDropHandler,g=x.DragElement,k=x.HitAreasGenerator,h=a("./elements_renderer"),m=a("./key_handler"),n=a("./mouse.widget"),r=a("./save_state_handler"),s=a("./scroll_handler"),t=a("./select_node_handler"),u=a("./simple.widget"),w=a("./node"),o=w.Node,q=w.Position,z=a("./util"),y=a("./node_element"),e=y.BorderDropHint,i=y.FolderElement,j=y.GhostDropHint,p=y.NodeElement,d=jQuery,l=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return A(b,a),b.prototype.BorderDropHint=e,b.prototype.DragElement=g,b.prototype.DragAndDropHandler=f,b.prototype.ElementsRenderer=h,b.prototype.GhostDropHint=j,b.prototype.HitAreasGenerator=k,b.prototype.Node=o,b.prototype.SaveStateHandler=r,b.prototype.ScrollHandler=s,b.prototype.SelectNodeHandler=t,b.prototype.defaults={autoOpen:!1,saveState:!1,dragAndDrop:!1,selectable:!0,useContextMenu:!0,onCanSelectNode:null,onSetStateFromStorage:null,onGetStateFromStorage:null,onCreateLi:null,onIsMoveHandle:null,onCanMove:null,onCanMoveTo:null,onLoadFailed:null,autoEscape:!0,dataUrl:null,closedIcon:null,openedIcon:"&#x25bc;",slide:!0,nodeClass:o,dataFilter:null,keyboardSupport:!0,openFolderDelay:500,rtl:null,onDragMove:null,onDragStop:null,buttonLeft:!0},b.prototype.toggle=function(a,b){return null==b&&(b=null),null===b&&(b=this.options.slide),a.is_open?this.closeNode(a,b):this.openNode(a,b),this.element},b.prototype.getTree=function(){return this.tree},b.prototype.selectNode=function(a){return this._selectNode(a,!1),this.element},b.prototype._selectNode=function(a,b){var c,d,e,f;if(null==b&&(b=!1),this.select_node_handler){if(c=function(b){return function(){return b.options.onCanSelectNode?b.options.selectable&&b.options.onCanSelectNode(a):b.options.selectable}}(this),e=function(b){return function(){var c;return c=a.parent,c&&c.parent&&!c.is_open?b.openNode(c,!1):void 0}}(this),f=function(a){return function(){return a.options.saveState?a.save_state_handler.saveState():void 0}}(this),!a)return this._deselectCurrentNode(),void f();if(c())return this.select_node_handler.isNodeSelected(a)?b&&(this._deselectCurrentNode(),this._triggerEvent("tree.select",{node:null,previous_node:a})):(d=this.getSelectedNode(),this._deselectCurrentNode(),this.addToSelection(a),this._triggerEvent("tree.select",{node:a,deselected_node:d}),e()),f()}},b.prototype.getSelectedNode=function(){return this.select_node_handler?this.select_node_handler.getSelectedNode():null},b.prototype.toJson=function(){return JSON.stringify(this.tree.getData())},b.prototype.loadData=function(a,b){return this._loadData(a,b),this.element},b.prototype.loadDataFromUrl=function(a,b,c){return"string"===d.type(a)?this._loadDataFromUrl(a,b,c):this._loadDataFromUrl(null,a,b),this.element},b.prototype.reload=function(a){return this._loadDataFromUrl(null,null,a),this.element},b.prototype._loadDataFromUrl=function(a,b,c){var e,f,g,h,i,j;e=null,f=function(a){return function(){return e=b?d(b.element):a.element,e.addClass("jqtree-loading")}}(this),j=function(){return e?e.removeClass("jqtree-loading"):void 0},i=function(){return"string"===d.type(a)&&(a={url:a}),a.method?void 0:a.method="get"},g=function(a){return function(e){return j(),a._loadData(e,b),c&&d.isFunction(c)?c():void 0}}(this),h=function(b){return function(){return i(),d.ajax({url:a.url,data:a.data,type:a.method.toUpperCase(),cache:!1,dataType:"json",success:function(a){var c;return c=d.isArray(a)||"object"==typeof a?a:d.parseJSON(a),b.options.dataFilter&&(c=b.options.dataFilter(c)),g(c)},error:function(a){return j(),b.options.onLoadFailed?b.options.onLoadFailed(a):void 0}})}}(this),a||(a=this._getDataUrlInfo(b)),f(),a?d.isArray(a)?g(a):h():j()},b.prototype._loadData=function(a,b){var c,d;return null==b&&(b=null),c=function(a){return function(){var c,d,e,f;if(a.select_node_handler)for(f=a.select_node_handler.getSelectedNodesUnder(b),c=0,d=f.length;d>c;c++)e=f[c],a.select_node_handler.removeFromSelection(e);return null}}(this),d=function(c){return function(){return b.loadFromData(a),b.load_on_demand=!1,b.is_loading=!1,c._refreshElements(b)}}(this),a?(this._triggerEvent("tree.load_data",{tree_data:a}),b?(c(),d()):this._initTree(a),this.isDragging()?this.dnd_handler.refresh():void 0):void 0},b.prototype.getNodeById=function(a){return this.tree.getNodeById(a)},b.prototype.getNodeByName=function(a){return this.tree.getNodeByName(a)},b.prototype.getNodesByProperty=function(a,b){return this.tree.getNodesByProperty(a,b)},b.prototype.openNode=function(a,b){return null==b&&(b=null),null===b&&(b=this.options.slide),this._openNode(a,b),this.element},b.prototype._openNode=function(a,b,c){var d,e;if(null==b&&(b=!0),d=function(a){return function(b,c,d){var e;return e=new i(b,a),e.open(d,c)}}(this),a.isFolder()){if(a.load_on_demand)return this._loadFolderOnDemand(a,b,c);for(e=a.parent;e;)e.parent&&d(e,!1,null),e=e.parent;return d(a,b,c),this._saveState()}},b.prototype._loadFolderOnDemand=function(a,b,c){return null==b&&(b=!0),a.is_loading=!0,this._loadDataFromUrl(null,a,function(d){return function(){return d._openNode(a,b,c)}}(this))},b.prototype.closeNode=function(a,b){return null==b&&(b=null),null===b&&(b=this.options.slide),a.isFolder()&&(new i(a,this).close(b),this._saveState()),this.element},b.prototype.isDragging=function(){return this.dnd_handler?this.dnd_handler.is_dragging:!1},b.prototype.refreshHitAreas=function(){return this.dnd_handler.refresh(),this.element},b.prototype.addNodeAfter=function(a,b){var c;return c=b.addAfter(a),this._refreshElements(b.parent),c},b.prototype.addNodeBefore=function(a,b){var c;return c=b.addBefore(a),this._refreshElements(b.parent),c},b.prototype.addParentNode=function(a,b){var c;return c=b.addParent(a),this._refreshElements(c.parent),c},b.prototype.removeNode=function(a){var b;return b=a.parent,b&&(this.select_node_handler.removeFromSelection(a,!0),a.remove(),this._refreshElements(b)),this.element},b.prototype.appendNode=function(a,b){var c;return b=b||this.tree,c=b.append(a),this._refreshElements(b),c},b.prototype.prependNode=function(a,b){var c;return b||(b=this.tree),c=b.prepend(a),this._refreshElements(b),c},b.prototype.updateNode=function(a,b){var c;return c=b.id&&b.id!==a.id,c&&this.tree.removeNodeFromIndex(a),a.setData(b),c&&this.tree.addNodeToIndex(a),this.renderer.renderFromNode(a),this._selectCurrentNode(),this.element},b.prototype.moveNode=function(a,b,c){var d;return d=q.nameToIndex(c),this.tree.moveNode(a,b,d),this._refreshElements(),this.element},b.prototype.getStateFromStorage=function(){return this.save_state_handler.getStateFromStorage()},b.prototype.addToSelection=function(a){return a&&(this.select_node_handler.addToSelection(a),this._getNodeElementForNode(a).select(),this._saveState()),this.element},b.prototype.getSelectedNodes=function(){return this.select_node_handler.getSelectedNodes()},b.prototype.isNodeSelected=function(a){return this.select_node_handler.isNodeSelected(a)},b.prototype.removeFromSelection=function(a){return this.select_node_handler.removeFromSelection(a),this._getNodeElementForNode(a).deselect(),this._saveState(),this.element},b.prototype.scrollToNode=function(a){var b,c;return b=d(a.element),c=b.offset().top-this.$el.offset().top,this.scroll_handler.scrollTo(c),this.element},b.prototype.getState=function(){return this.save_state_handler.getState()},b.prototype.setState=function(a){return this.save_state_handler.setInitialState(a),this._refreshElements(),this.element},b.prototype.setOption=function(a,b){return this.options[a]=b,this.element},b.prototype.moveDown=function(){return this.key_handler&&this.key_handler.moveDown(),this.element},b.prototype.moveUp=function(){return this.key_handler&&this.key_handler.moveUp(),this.element},b.prototype.getVersion=function(){return v},b.prototype._init=function(){return b.__super__._init.call(this),this.element=this.$el,this.mouse_delay=300,this.is_initialized=!1,this.options.rtl=this._getRtlOption(),this.options.closedIcon||(this.options.closedIcon=this._getDefaultClosedIcon()),this.renderer=new h(this),null!=r?this.save_state_handler=new r(this):this.options.saveState=!1,null!=t&&(this.select_node_handler=new t(this)),null!=f?this.dnd_handler=new f(this):this.options.dragAndDrop=!1,null!=s&&(this.scroll_handler=new s(this)),null!=m&&null!=t&&(this.key_handler=new m(this)),this._initData(),this.element.click(d.proxy(this._click,this)),this.element.dblclick(d.proxy(this._dblclick,this)),this.options.useContextMenu?this.element.bind("contextmenu",d.proxy(this._contextmenu,this)):void 0},b.prototype._deinit=function(){return this.element.empty(),this.element.unbind(),this.key_handler&&this.key_handler.deinit(),this.tree=null,b.__super__._deinit.call(this)},b.prototype._initData=function(){return this.options.data?this._loadData(this.options.data):this._loadDataFromUrl(this._getDataUrlInfo())},b.prototype._getDataUrlInfo=function(a){var b,c;return b=this.options.dataUrl||this.element.data("url"),c=function(c){return function(){var d,e,f;return f={url:b},a&&a.id?(d={node:a.id},f.data=d):(e=c._getNodeIdToBeSelected(),e&&(d={selected_node:e},f.data=d)),f}}(this),d.isFunction(b)?b(a):"string"===d.type(b)?c():b},b.prototype._getNodeIdToBeSelected=function(){return this.options.saveState?this.save_state_handler.getNodeIdToBeSelected():null},b.prototype._initTree=function(a){var b,c;return b=function(a){return function(){return a.is_initialized?void 0:(a.is_initialized=!0,a._triggerEvent("tree.init"))}}(this),this.tree=new this.options.nodeClass(null,!0,this.options.nodeClass),this.select_node_handler&&this.select_node_handler.clear(),this.tree.loadFromData(a),c=this._setInitialState(),this._refreshElements(),c?this._setInitialStateOnDemand(b):b()},b.prototype._setInitialState=function(){var a,b,c,d,e;return e=function(a){return function(){var b,c;return a.options.saveState&&a.save_state_handler?(c=a.save_state_handler.getStateFromStorage(),c?(b=a.save_state_handler.setInitialState(c),[!0,b]):[!1,!1]):[!1,!1]}}(this),a=function(a){return function(){var b,c;return a.options.autoOpen===!1?!1:(b=a._getAutoOpenMaxLevel(),c=!1,a.tree.iterate(function(a,d){return a.load_on_demand?(c=!0,!1):a.hasChildren()?(a.is_open=!0,d!==b):!1}),c)}}(this),d=e(),b=d[0],c=d[1],b||(c=a()),c},b.prototype._setInitialStateOnDemand=function(a){var b,c;return c=function(b){return function(){var c;return b.options.saveState&&b.save_state_handler?(c=b.save_state_handler.getStateFromStorage(),c?(b.save_state_handler.setInitialStateOnDemand(c,a),!0):!1):!1}}(this),b=function(b){return function(){var c,d,e,f;return e=b._getAutoOpenMaxLevel(),d=0,c=function(a){return d+=1,b._openNode(a,!1,function(){return d-=1,f()})},(f=function(){return b.tree.iterate(function(a,d){return a.load_on_demand?(a.is_loading||c(a),!1):(b._openNode(a,!1),d!==e)}),0===d?a():void 0})()}}(this),c()?void 0:b()},b.prototype._getAutoOpenMaxLevel=function(){return this.options.autoOpen===!0?-1:parseInt(this.options.autoOpen)},b.prototype._refreshElements=function(a){return null==a&&(a=null),this.renderer.render(a),this._triggerEvent("tree.refresh")},b.prototype._click=function(a){var b,c,d;if(b=this._getClickTarget(a.target)){if("button"===b.type)return this.toggle(b.node,this.options.slide),a.preventDefault(),a.stopPropagation();if("label"===b.type&&(d=b.node,c=this._triggerEvent("tree.click",{node:d,click_event:a}),!c.isDefaultPrevented()))return this._selectNode(d,!0)}},b.prototype._dblclick=function(a){var b;return b=this._getClickTarget(a.target),b&&"label"===b.type?this._triggerEvent("tree.dblclick",{node:b.node,click_event:a}):void 0},b.prototype._getClickTarget=function(a){var b,c,e,f;if(e=d(a),b=e.closest(".jqtree-toggler"),b.length){if(f=this._getNode(b))return{type:"button",node:f}}else if(c=e.closest(".jqtree-element"),c.length&&(f=this._getNode(c)))return{type:"label",node:f};return null},b.prototype._getNode=function(a){var b;return b=a.closest("li.jqtree_common"),0===b.length?null:b.data("node")},b.prototype._getNodeElementForNode=function(a){return a.isFolder()?new i(a,this):new p(a,this)},b.prototype._getNodeElement=function(a){var b;return b=this._getNode(a),b?this._getNodeElementForNode(b):null},b.prototype._contextmenu=function(a){var b,c;return b=d(a.target).closest("ul.jqtree-tree .jqtree-element"),b.length&&(c=this._getNode(b))?(a.preventDefault(),a.stopPropagation(),this._triggerEvent("tree.contextmenu",{node:c,click_event:a}),!1):void 0},b.prototype._saveState=function(){return this.options.saveState?this.save_state_handler.saveState():void 0},b.prototype._mouseCapture=function(a){return this.options.dragAndDrop?this.dnd_handler.mouseCapture(a):!1},b.prototype._mouseStart=function(a){return this.options.dragAndDrop?this.dnd_handler.mouseStart(a):!1},b.prototype._mouseDrag=function(a){var b;return this.options.dragAndDrop?(b=this.dnd_handler.mouseDrag(a),this.scroll_handler&&this.scroll_handler.checkScrolling(),b):!1},b.prototype._mouseStop=function(a){return this.options.dragAndDrop?this.dnd_handler.mouseStop(a):!1},b.prototype._triggerEvent=function(a,b){var c;return c=d.Event(a),d.extend(c,b),this.element.trigger(c),c},b.prototype.testGenerateHitAreas=function(a){return this.dnd_handler.current_item=this._getNodeElementForNode(a),this.dnd_handler.generateHitAreas(),this.dnd_handler.hit_areas},b.prototype._selectCurrentNode=function(){var a,b;return a=this.getSelectedNode(),a&&(b=this._getNodeElementForNode(a))?b.select():void 0},b.prototype._deselectCurrentNode=function(){var a;return a=this.getSelectedNode(),a?this.removeFromSelection(a):void 0},b.prototype._getDefaultClosedIcon=function(){return this.options.rtl?"&#x25c0;":"&#x25ba;"},b.prototype._getRtlOption=function(){var a;return null!==this.options.rtl?this.options.rtl:(a=this.element.data("rtl"),null!=a&&a!==!1?!0:!1)},b}(n),l.getModule=function(a){var b;return b={node:w,util:z},b[a]},u.register(l,"tree")},{"./drag_and_drop_handler":1,"./elements_renderer":2,"./key_handler":3,"./mouse.widget":4,"./node":5,"./node_element":6,"./save_state_handler":7,"./scroll_handler":8,"./select_node_handler":9,"./simple.widget":10,"./util":12,"./version":13}],12:[function(a,b,c){var d,e,f,g,h;d=function(a,b){var c,d,e,f;for(c=d=0,e=a.length;e>d;c=++d)if(f=a[c],f===b)return c;return-1},g=function(a,b){return a.indexOf?a.indexOf(b):d(a,b)},h=function(a){return"number"==typeof a&&a%1===0},f=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},e=function(a){return a?"true":"false"},b.exports={_indexOf:d,getBoolString:e,html_escape:f,indexOf:g,isInt:h}},{}],13:[function(a,b,c){b.exports="1.3.0"},{}]},{},[11]);var rex_treestructure={treeCss:"treetructure--tree",new_article:null,new_category:null,is_touch:"ontouchstart"in document.documentElement,init:function(){this.createEvents(),this.createTree(),this.is_touch?$("#"+this.treeCss).addClass("is--touch"):$("#"+this.treeCss).addClass("is--no-touch")},createEvents:function(){var a=$("#"+this.treeCss);a.on({"click.treestructure":function(a){var b=$(this).attr("class").match(/treestructure--options--([^ ]+)( |$)/),c=$(this).parents("#"+rex_treestructure.treeCss).first(),d=$(this).parents("li").first(),e=d.attr("data-id"),f=c?c.tree("getNodeById",e):null;if(!b||!c||$(this).css("opacity")<1)return!1;if(b=b[1].replace(/-([a-z])/g,function(a){return a[1].toUpperCase()}),"function"==typeof rex_treestructure.itemActions[b]){if($(this).attr("data-confirm")){var g=!0;if(g=a.shiftKey?f.name==prompt(rex_treestructure._translate($(this).attr("data-confirm"),{name:f.name})+"\n"+rex_treestructure._translate("type_in_name_to_confirm",{name:f.name})):confirm(rex_treestructure._translate($(this).attr("data-confirm"),{name:f.name})),!g)return!1}rex_treestructure.itemActions[b](f,d,c,a.shiftKey)}return!1},"mousedown.treestructure":function(a){try{a.preventDefault()}catch(b){}return!1}},'.treestructure--options span[class*="treestructure--options--"]'),a.on({"submit.treestructure":function(a){try{a.preventDefault()}catch(b){}return $(this).find('input[name="name"]').length&&($(this).find('input[name="name"]').val($.trim($(this).find('input[name="name"]').val()).replace(/\s/g," ").replace(/ +/g," ")),""==$(this).find('input[name="name"]').val())?!1:(rex_treestructure.ajaxAction($(this).serialize(),rex_treestructure.updateTree),!1)},"reset.treestructure":function(){var a=$(this).tree("getNodeById",-1)||null;return a&&$(this).tree("removeNode",a),$(this).find(".treestructure--edit-node").length&&$(this).find(".treestructure--edit-node").each(function(a,b){var c=$(b).parents("li").first();c.removeClass("is--editing"),c.find(">.jqtree-element>.jqtree-title").html(c.data("tmp-html")),c.data("tmp-html",null),$(b).remove()}),!1}})},updateTree:function(){var a=$("#"+rex_treestructure.treeCss),b=$("#"+rex_treestructure.treeCss).tree("getState");a.tree("loadDataFromUrl",a.attr("data-url"),null,function(){a.tree("setOption","dragAndDrop",!0),a.tree("setState",b),rex_treestructure.editTree(!1)})},editTree:function(){var a=$("#"+rex_treestructure.treeCss);if("undefined"==typeof arguments[0])return a.hasClass("is--edit");var b=arguments[0]===!0;b?(a.tree("setOption","dragAndDrop",!1),a.addClass("is--edit"),$(document).on("keyup.treestructure",function(a){27==a.keyCode&&rex_treestructure.editTree(!1)})):(a.trigger("reset.treestructure"),$(document).off("keyup.treestructure"),a.tree("setOption","dragAndDrop",!0),a.removeClass("is--edit"))},loadingTree:function(){var a="undefined"!=typeof arguments[0]&&arguments[0]===!0,b=$("#"+rex_treestructure.treeCss);return a?b.addClass("is--loading"):b.removeClass("is--loading"),b},_translate:function(a,b){var c=$("#"+rex_treestructure.treeCss)||null,d=null;if(c.attr("data-translations")&&(d=JSON.parse(c.attr("data-translations")),"object"==typeof d&&"undefined"!=typeof d[a]&&(a=d[a])),"object"==typeof b)for(var e in b)a=a.replace("{{"+e+"}}",b[e]);return a},ajaxAction:function(a){if("undefined"==typeof a)return!1;var b,c=rex_treestructure.loadingTree(!0),d="function"==typeof arguments[1]?arguments[1]:null;b=a instanceof FormData||"string"==typeof a?a:Object.keys(a).map(function(b){return encodeURIComponent(b)+"="+encodeURIComponent(a[b])}).join("&");var e=new XMLHttpRequest;e.open(c.attr("method")||"GET",c.attr("action"),!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d&&(e.onSuccess=d),e.onload=function(){var a,b=JSON.parse(this.responseText),c=(this.status,rex_treestructure.loadingTree(!1)),d=2e3,f=0;e.status>=200&&e.status<400&&this.onSuccess&&this.onSuccess(b),"undefined"!=typeof b.notice?a=$('<div id="treestructure--alert" class="alert alert-success" />').text(b.notice):"undefined"!=typeof b.error&&(a=$('<div id="treestructure--alert" class="alert alert-danger" />').text(b.error),f=3e3),a&&(a.insertBefore(c),a.data("fadeFunc",function(a){$(this).animate({opacity:0},a,function(){$(this).remove()})}.bind(a,d)),f>0?a.data("timeout",window.setTimeout(a.data("fadeFunc"),f)):a.data("fadeFunc")())},e.send(b)},itemActions:{"delete":function(a,b,c){return b.hasClass("cannot-delete")?!1:void rex_treestructure.ajaxAction({action:"delete",id:a.id,type:a.type,force:arguments[3]===!0},rex_treestructure.updateTree)},edit:function(a,b,c){return b.hasClass("cannot-edit")?!1:(rex_treestructure.editTree(!0),void rex_treestructure.ajaxAction({action:"editform",category_id:-1,id:a.id,type:a.type},function(a){b.addClass("is--editing").data("tmp-html",b.find(">.jqtree-element>.jqtree-title").html()),b.find(">.jqtree-element>.jqtree-title").html(a.html),b.find(">.jqtree-element>.jqtree-title").find("input").focus()}.bind(b)))},status:function(a,b,c){return b.hasClass("cannot-publish")?!1:void rex_treestructure.ajaxAction({action:"status",id:a.id,type:a.type,status:a.status?!1:!0},rex_treestructure.updateTree)},newCategory:function(a,b,c){return b.hasClass("cannot-edit")?!1:void this._newElement(a,b,c,"category")},newArticle:function(a,b,c){return b.hasClass("cannot-edit")?!1:void this._newElement(a,b,c,"article")},_newElement:function(a,b,c,d){rex_treestructure.editTree(!0),rex_treestructure.ajaxAction({action:"editform",category_id:a.id,type:d},function(a){if(this.newNode.label=a.html,null!=this.targetNode){this.targetNode=this.$tree.tree("getNodeById",this.targetNode.attr("data-id"));var b=this.$tree.tree("addNodeAfter",this.newNode,this.targetNode)}else var b=this.$tree.tree("appendNode",this.newNode,this.node);this.$tree.tree("openNode",this.node,!1),$(b.element).find("input").focus()}.bind({node:a,newNode:{id:-1,type:d,status:!1,has_children:!1,cat_perm:a.cat_perm},$tree:c,targetNode:b.find(">ul.jqtree_common>li.treestructure--"+d).length?b.find(">ul.jqtree_common>li.treestructure--"+d).last():null}))},view:function(a,b,c){window.open(a.url)},metadata:function(a,b,c){window.location.href="?page=content/metainfo&article_id="+a.id},functions:function(a,b,c){window.location.href="?page=content/functions&article_id="+a.id},_expandCollapseAll:function(a){var b=arguments[1]===!0&&"undefined"==typeof arguments[2]||arguments[2]===!0,c="undefined"!=typeof arguments[2]?arguments[1]:a.tree("getTree");"root"!=c.type&&a.tree(b?"openNode":"closeNode",c),c.iterate(function(c,d){return a.tree(b?"openNode":"closeNode",c),!0})},expandAll:function(a,b,c){this._expandCollapseAll(c,a,!0)},collapseAll:function(a,b,c){this._expandCollapseAll(c,a,!1)}},createTree:function(){$("#"+this.treeCss).tree({autoEscape:!1,autoOpen:1,useContextMenu:!1,dragAndDrop:!0,saveState:"treestructure-tree",selectable:!1,onCanMoveTo:function(a,b,c){var d=a.parent.id==b.parent.id,e=b.getNextSibling(),f=b.getPreviousSibling();if("inside"!=c&&!b.parent.parent)return!1;if("inside"==c){if("article"==b.type)return!1;if("article"==a.type&&a.parent.id==b.id)return!1;if(a.permissions.match(/cannot-move/)&&a.parent.id!=b.id)return!1}else if(a.permissions.match(/cannot-move/)&&a.parent.id!=b.parent.id)return!1;if(!d)for(p=b.parent;p;){if(p.id==a.id)return!1;p=p.parent}for(var g=!0,h=0;h<a.parent.children.length;h++){var i=a.parent.children[h];if(i.id==a.id)break;if(i.id==b.id){g=!1;break}}if(g&&(e=e?e.getNextSibling():e,f=f?f.getNextSibling():f),"article"==a.type&&"after"==c&&e&&"article"!=e.type)return!1;if("category"==a.type&&"after"==c)if(e&&f){if("category"!=f.type)return!1}else{if(f&&"category"!=f.type)return!1;if("category"!=b.type)return!1}if("inside"==c&&b.children.length){c="after";for(var h=b.children.length-1;h>=0;h--){var i=b.children[h];if(i.type==a.type){b=i;break}}return!0}return!0},onCanMove:function(a){return a.parent.parent?!0:!1},onCreateLi:function(a,b){b.addClass("treestructure--"+a.type),b.addClass(a.status?"is--online":"is--offline"),a.has_children&&b.addClass("has--children"),a.cat_perm&&b.addClass("is--allowed"),a.permissions&&b.addClass(a.permissions),b.addClass("has--prior-"+a.prior),a.id<0?b.addClass("is--new"):$("#"+rex_treestructure.treeCss).next(".treestructure--options").clone(1,1).insertAfter(b.find(".jqtree-title")),b.attr("data-id",a.id)}}).on({"tree.move":function(a){a.preventDefault();var b=a.move_info;return target_node=null,position=null,b.do_move(target_node,position),rex_treestructure.ajaxAction({action:"move",id:b.moved_node.id,category_id:"inside"==b.position?b.target_node.id:b.target_node.parent.id,prior:"inside"==b.position?1:parseInt(b.target_node.prior),type:b.moved_node.type},rex_treestructure.updateTree),!0}})}};$(document).on("rex:ready",function(a,b){rex_treestructure.init()});